
# Project.md: Локальная система подготовки персонала

## 1. Введение и цели

**Название проекта:** Локальная система подготовки персонала (LMS Local)

**Цель:** Разработать полностью автономную систему для обучения персонала, работающую в корпоративной сети без доступа к интернету. Система должна позволять сотрудникам самостоятельно проходить курсы, уроки и тесты, а администраторам — управлять контентом и отслеживать прогресс.

**Ключевые ограничения:**
- **Полная автономность:** Работа без интернет-соединения. Все ресурсы (стили, скрипты, библиотеки) хранятся локально.
- **Отсутствие сервера:** Система функционирует как клиентское SPA-приложение, запускаемое из файла `start.html`.
- **Нулевая установка:** На клиентских машинах разрешено использовать только браузер, установка ПО запрещена.
- **Хранилище данных:** Все данные (пользователи, курсы, прогресс) хранятся в `localStorage` браузера.

## 2. Архитектура системы

Система строится по принципу **Single Page Application (SPA)**. Вся логика, рендеринг и управление состоянием выполняются на стороне клиента с помощью JavaScript.

### 2.1. Структура проекта

```
/
├── start.html              # Главная точка входа в приложение
├── css/
│   ├── bootstrap.min.css   # Стили Bootstrap 5
│   └── custom.css          # Пользовательские стили
├── js/
│   ├── core.js             # Ядро приложения: роутинг, инициализация
│   ├── storage.js          # Модуль для всех операций с localStorage
│   ├── auth.js             # Логика аутентификации и управления ролями
│   ├── shortcodes.js       # Парсер шорткодов для контента уроков
│   ├── admin.js            # Общая логика для панели администратора
│   ├── users.js            # Логика для панели обучаемого
│   ├── admin/
│   │   ├── dashboard.js    # Логика дашборда
│   │   ├── courses.js      # CRUD операции для курсов и уроков
│   │   ├── quizzes.js      # CRUD операции для тестов
│   │   └── reports.js      # Генерация и экспорт отчетов
│   └── quizzes/
│       ├── single.js       # Логика теста "выбор одного"
│       ├── multiple.js     # Логика теста "выбор нескольких"
│       └── ...             # Файлы для других типов тестов
├── docs/
│   ├── Project.md          # Этот документ
│   ├── Tasktracker.md      # Трекер задач
│   ├── Diary.md            # Дневник разработки
│   └── qa.md               # Вопросы и ответы
└── files/                  # Папка для контента (изображения, PDF, видео)
```

### 2.2. Модули системы

- **`core.js` (Ядро):** Отвечает за "маршрутизацию" (отображение нужных секций/страниц в зависимости от URL hash), инициализацию всех модулей при старте.
- **`storage.js` (Хранилище):** Абстракция над `localStorage`. Предоставляет методы `get`, `set`, `update` для работы с данными. Вся работа с `localStorage` должна идти только через этот модуль.
- **`auth.js` (Аутентификация):** Управляет "входом" пользователя (выбор роли), хранит текущего пользователя в сессии (или `sessionStorage`).
- **`shortcodes.js` (Парсер шорткодов):** Обрабатывает текст урока, заменяя шорткоды (`[img]`, `[quiz]`, и т.д.) на соответствующий HTML-код.
- **Модули администратора (`js/admin/*.js`):** Реализуют функционал админ-панели.
- **Модули тестов (`js/quizzes/*.js`):** Каждый файл инкапсулирует логику для одного типа теста. Это позволяет легко добавлять новые типы.

### 2.3. Структура данных в `localStorage`

Все данные будут храниться в виде одного JSON-объекта под ключом `lms_local_data`.

```json
{
  "users": [
    { "id": 1, "name": "Администратор", "role": "admin" },
    { "id": 2, "name": "Иванов И.И.", "role": "user" }
  ],
  "courses": [
    {
      "id": "c1",
      "title": "Вводный курс по безопасности",
      "lessons": [
        { "id": "l1-1", "title": "Правила поведения", "content": "Текст урока...", "isLocked": false },
        { "id": "l1-2", "title": "Тест по правилам", "content": "[quiz:q1]", "isLocked": true }
      ]
    }
  ],
  "quizzes": {
    "q1": { "type": "single", "question": "...", "answers": [...] }
  },
  "userProgress": {
    "2": {
      "c1": {
        "l1-1": "completed",
        "l1-2": "in_progress"
      }
    }
  },
  "feedback": [
      { "lessonId": "l1-1", "userId": 2, "text": "Непонятен пункт 5.", "timestamp": "..." }
  ],
  "finalReviews": [
      { "userId": 2, "text": "Отличный курс!", "timestamp": "..." }
  ]
}
```

## 3. Технологический стек

- **Frontend:** HTML5, CSS3, JavaScript (ES6+).
- **UI Framework:** Bootstrap 5.
- **Библиотеки:**
  - Для поиска по контенту будет интегрирована `Lunr.js` или `FlexSearch.js`.
  - Для экспорта в CSV может быть использована `PapaParse`.
- **Формат контента:** Markdown для уроков.

## 4. Этапы разработки (MVP)

1.  **Инициализация проекта:** Настройка структуры, создание базовых файлов.
2.  **Ядро и хранилище:** Реализация `core.js` и `storage.js`.
3.  **Аутентификация:** Создание формы входа и логики `auth.js`.
4.  **Панель администратора (CRUD курсов):** Реализация создания, редактирования, удаления курсов и уроков.
5.  **Парсер шорткодов:** Базовая реализация для `[img]` и `[file]`.
6.  **Панель обучаемого:** Отображение списка курсов и контента уроков.
7.  **Система тестов:** Реализация одного типа теста (например, "выбор одного") и его интеграция через шорткод `[quiz]`.
8.  **Отслеживание прогресса:** Сохранение статуса прохождения уроков.

## 5. Стандарты кодирования

- **Стиль:** Придерживаться общепринятых стандартов JavaScript. Использовать линтер (например, ESLint) для поддержания консистентности.
- **Комментарии:** Ключевые и сложные участки кода должны быть прокомментированы. Каждый файл должен содержать заголовок с его описанием.
- **Модульность:** Функционал должен быть максимально разделен на модули (принцип единственной ответственности).
